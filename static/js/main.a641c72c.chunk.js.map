{"version":3,"sources":["context/AuthContext.js","utils/PrivateRoute.js","pages/homepage.js","pages/LoginPage.js","components/Header.js","App.js","index.js"],"names":["AuthContext","createContext","AuthProvider","children","useState","localStorage","getItem","JSON","parse","authTokens","setauthTokens","jwt_decode","user","setUser","loading","history","useHistory","loginUser","e","a","preventDefault","fetch","method","headers","body","stringify","target","username","value","password","response","json","data","status","access","setItem","push","alert","logoutUser","removeItem","updateToken","console","log","refresh","contextData","useEffect","interval","setInterval","clearInterval","Provider","PrivateRoute","rest","useContext","to","homepage","href","LoginPage","class","onSubmit","type","name","placeholder","Header","onClick","App","className","component","path","exact","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.a641c72c.chunk.js","sourcesContent":["import { createContext, useState, useEffect } from \"react\";\nimport jwt_decode from \"jwt-decode\";\nimport { useHistory } from 'react-router-dom'\n\nconst AuthContext = createContext()\n\nexport default AuthContext;\n\nexport const AuthProvider = ({children}) => {\n\n    \n    let [authTokens, setauthTokens] = useState(() => localStorage.getItem('authTokens') ? JSON.parse(localStorage.getItem('authTokens')) : null)\n    let [user, setUser] = useState(() => localStorage.getItem('authTokens') ? jwt_decode(localStorage.getItem('authTokens')) : null)\n    let [loading, setLoading] = useState(true)\n    const history = useHistory()\n\n    let loginUser = async (e )=> {\n        e.preventDefault()\n        let response = await fetch('http://127.0.0.1:8000/api/token/', {\n            method:'POST',\n            headers:{\n                'Content-Type':'application/json'\n            },\n            body:JSON.stringify({'username':e.target.username.value, 'password':e.target.password.value})\n        })\n        let data = await response.json()\n        if(response.status === 200){\n            setauthTokens(data)\n            setUser(jwt_decode(data.access))\n            localStorage.setItem('authTokens', JSON.stringify(data))\n            history.push('/')\n        }else{\n            alert(\"Something Went Wrong!\")\n        }\n    }\n\n    let logoutUser = () =>{\n        setauthTokens(null)\n        setUser(null)\n        localStorage.removeItem('authTokens')\n        history.push('/login')\n    }\n\n    let updateToken = async () => {\n        console.log('update token called')\n        let response = await fetch('http://127.0.0.1:8000/api/token/refresh/', {\n            method:'POST',\n            headers:{\n                'Content-Type':'application/json'\n            },\n            body:JSON.stringify({'refresh':authTokens.refresh})\n        })\n        let data = await response.json()\n\n        if(response.status === 200){\n            setauthTokens(data)\n            setUser(jwt_decode(data.access))\n            localStorage.setItem('authTokens', JSON.stringify(data))\n        }else{\n            logoutUser()\n        }\n    }\n\n    let contextData = {\n        user:user,\n        loginUser:loginUser,\n        logoutUser:logoutUser,\n    }\n\n    useEffect(()=>{\n        let fourMinutes = 1000*60*4\n        let interval = setInterval(()=>{\n            if(authTokens){\n                updateToken()\n            }\n        }, fourMinutes)\n        return ()=> clearInterval(interval)\n\n    }, [authTokens, loading])\n\n    return(\n        <AuthContext.Provider value={contextData}>\n            {children}\n        </AuthContext.Provider>\n    )\n}","import { Route, Redirect } from 'react-router-dom'\nimport { useContext  } from 'react'\nimport AuthContext from '../context/AuthContext'\n\n\nconst PrivateRoute = ({children, ...rest}) => {\n    let {user} = useContext(AuthContext)\n    return(\n        <Route {...rest}>\n            {!user ? <Redirect to=\"/login\" /> : children}\n        </Route>\n    )\n}\n\nexport default PrivateRoute","import React from 'react'\n\n\nconst homepage = () => {\n    return (\n        \n        <div>\n             \n            <h2>You are logged in to the main page</h2>\n            <p>To be redirected to your MyLife feed click the button bellow</p>\n\n            <a href=\"https://nikadari.github.io/CPS530client/\"><button>My Feed</button></a>\n        </div>\n    )\n}\n\nexport default homepage\n","import React, { useContext } from 'react'\nimport AuthContext from '../context/AuthContext'\n\nconst LoginPage = () => {\n    let {loginUser} = useContext(AuthContext)\n    return (\n        <div>\n            \n            <h3 class=\"mb-5\">Sign in</h3>\n\t\t\t\n            <form onSubmit={loginUser}>\n            <div class=\"form-outline mb-4\">\n             <input type=\"text\" name=\"username\" placeholder='Enter Username'></input>\n            </div>\n\n            <div class=\"form-outline mb-4\">\n              <input type=\"password\" name=\"password\" placeholder=\"Enter Password\"></input>\n            </div>\n            <br/>\n            <input type=\"submit\"/>\n            </form>\n\t\t\t\n\n\n         \n        </div>\n    )\n}\n\nexport default LoginPage\n","import React, {useContext} from 'react'\nimport { Link } from 'react-router-dom'\nimport AuthContext from '../context/AuthContext'\n\nconst Header = () => {\n    let{user, logoutUser} = useContext(AuthContext);\n    return (\n        <div>\n            <Link to=\"/\" ><button>HOME</button></Link>\n            <span>   |   </span>\n            {user ? (\n                <button onClick={logoutUser}>LOGOUT</button>\n            ): (\n            <Link to=\"/login\" ><button>LOGIN</button></Link>\n            )}\n\n            \n\n            {user && <h1>Hello {user.username}</h1>}\n              \n        </div>\n    )\n}\n\nexport default Header\n","\nimport './App.css';\nimport { BrowserRouter as Router, Route } from 'react-router-dom';\nimport PrivateRoute from './utils/PrivateRoute'\nimport { AuthProvider } from './context/AuthContext'\n\nimport homepage from './pages/homepage'\nimport LoginPage from './pages/LoginPage'\nimport Header from './components/Header'\n\n\nfunction App() {\n  return (\n    <div className=\"App\">\n      \n          <Router>\n          \n            <AuthProvider>\n            <Header />\n            <PrivateRoute component={homepage} path=\"/\" exact />\n            <Route component={LoginPage} path=\"/login\" />\n            </AuthProvider>\n          </Router>\n      \n      </div>\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\n\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n"],"sourceRoot":""}