(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{24:function(e,t,n){},35:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n.n(r),s=n(16),a=n.n(s),o=(n(24),n(5)),i=n(2),u=n(15),l=n(19),j=n(7),b=n.n(j),h=n(12),O=n(9),d=n(8),p=n(1),f=Object(r.createContext)(),x=f,g=function(e){var t=e.children,n=Object(r.useState)((function(){return localStorage.getItem("authTokens")?JSON.parse(localStorage.getItem("authTokens")):null})),c=Object(O.a)(n,2),s=c[0],a=c[1],o=Object(r.useState)((function(){return localStorage.getItem("authTokens")?Object(d.a)(localStorage.getItem("authTokens")):null})),u=Object(O.a)(o,2),l=u[0],j=u[1],x=Object(r.useState)(!0),g=Object(O.a)(x,2),m=g[0],v=(g[1],Object(i.f)()),S=function(){var e=Object(h.a)(b.a.mark((function e(t){var n,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,fetch("http://127.0.0.1:8000/api/token/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:t.target.username.value,password:t.target.password.value})});case 3:return n=e.sent,e.next=6,n.json();case 6:r=e.sent,200===n.status?(a(r),j(Object(d.a)(r.access)),localStorage.setItem("authTokens",JSON.stringify(r)),v.push("/")):alert("Something Went Wrong!");case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),k=function(){a(null),j(null),localStorage.removeItem("authTokens"),v.push("/login")},y=function(){var e=Object(h.a)(b.a.mark((function e(){var t,n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("update token called"),e.next=3,fetch("http://127.0.0.1:8000/api/token/refresh/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refresh:s.refresh})});case 3:return t=e.sent,e.next=6,t.json();case 6:n=e.sent,200===t.status?(a(n),j(Object(d.a)(n.access)),localStorage.setItem("authTokens",JSON.stringify(n))):k();case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),T={user:l,loginUser:S,logoutUser:k};return Object(r.useEffect)((function(){var e=setInterval((function(){s&&y()}),24e4);return function(){return clearInterval(e)}}),[s,m]),Object(p.jsx)(f.Provider,{value:T,children:t})},m=["children"],v=function(e){var t=e.children,n=Object(l.a)(e,m),c=Object(r.useContext)(x).user;return Object(p.jsx)(i.b,Object(u.a)(Object(u.a)({},n),{},{children:c?t:Object(p.jsx)(i.a,{to:"/login"})}))},S=function(){return Object(p.jsxs)("div",{children:[Object(p.jsx)("h2",{children:"You are logged in to the main page"}),Object(p.jsx)("p",{children:"To be redirected to your MyLife feed click the button bellow"}),Object(p.jsx)("a",{href:"https://nikadari.github.io/CPS530client/",children:Object(p.jsx)("button",{children:"My Feed"})})]})},k=function(){var e=Object(r.useContext)(x).loginUser;return Object(p.jsxs)("div",{children:[Object(p.jsx)("h3",{class:"mb-5",children:"Sign in"}),Object(p.jsxs)("form",{onSubmit:e,children:[Object(p.jsx)("div",{class:"form-outline mb-4",children:Object(p.jsx)("input",{type:"text",name:"username",placeholder:"Enter Username"})}),Object(p.jsx)("div",{class:"form-outline mb-4",children:Object(p.jsx)("input",{type:"password",name:"password",placeholder:"Enter Password"})}),Object(p.jsx)("br",{}),Object(p.jsx)("input",{type:"submit"})]})]})},y=function(){var e=Object(r.useContext)(x),t=e.user,n=e.logoutUser;return Object(p.jsxs)("div",{children:[Object(p.jsx)(o.b,{to:"/",children:Object(p.jsx)("button",{children:"HOME"})}),Object(p.jsx)("span",{children:"   |   "}),t?Object(p.jsx)("button",{onClick:n,children:"LOGOUT"}):Object(p.jsx)(o.b,{to:"/login",children:Object(p.jsx)("button",{children:"LOGIN"})}),t&&Object(p.jsxs)("h1",{children:["Hello ",t.username]})]})};var T=function(){return Object(p.jsx)("div",{className:"App",children:Object(p.jsx)(o.a,{children:Object(p.jsxs)(g,{children:[Object(p.jsx)(y,{}),Object(p.jsx)(v,{component:S,path:"/",exact:!0}),Object(p.jsx)(i.b,{component:k,path:"/login"})]})})})};a.a.render(Object(p.jsx)(c.a.StrictMode,{children:Object(p.jsx)(T,{})}),document.getElementById("root"))}},[[35,1,2]]]);
//# sourceMappingURL=main.a641c72c.chunk.js.map